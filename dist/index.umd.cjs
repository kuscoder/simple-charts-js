(function(a,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(a=typeof globalThis<"u"?globalThis:a||self,l(a.SimpleChartsJS={}))})(this,function(a){"use strict";var S=Object.defineProperty;var L=(a,l,I)=>l in a?S(a,l,{enumerable:!0,configurable:!0,writable:!0,value:I}):a[l]=I;var n=(a,l,I)=>(L(a,typeof l!="symbol"?l+"":l,I),I);const l="";function I(v,t){let i;return(...e)=>{clearTimeout(i),i=setTimeout(()=>v(...e),t)}}function H(v,t){let i;return(...e)=>{i||(i=setTimeout(()=>{v(...e),i=null},t))}}class C extends Error{constructor(t){super(t),this.name="ChartError"}}class s extends C{constructor(t){super(t),this.name="ChartOptionsError"}}const g=class g{constructor(t,i={}){n(this,"WIDTH");n(this,"HEIGHT");n(this,"PADDING");n(this,"ROWS_COUNT");n(this,"DATA");n(this,"I18N");n(this,"INTERACTIVITY");n(this,"STYLE");n(this,"TECHNICAL");n(this,"DPI_WIDTH");n(this,"DPI_HEIGHT");n(this,"VIEW_WIDTH");n(this,"VIEW_HEIGHT");n(this,"VERTICES_BOUNDARIES");n(this,"X_RATIO");n(this,"Y_RATIO");n(this,"ROWS_STEP");n(this,"TEXT_STEP");n(this,"TIMELINE_ITEMS_COUNT");n(this,"TIMELINE_ITEMS_STEP");n(this,"mouse");n(this,"isInitialized",!1);n(this,"rafID",0);n(this,"containerElement");n(this,"wrapperElement");n(this,"canvasElement");n(this,"tooltipElement");n(this,"canvasRect");n(this,"ctx");var o;const e=g.getOptions(i),r=((o=e.data.timeline)==null?void 0:o.values.length)||0,h=this.getVerticesLongestLength(e.data.vertices);this.containerElement=t,this.WIDTH=e.width,this.HEIGHT=e.height,this.PADDING=e.padding,this.ROWS_COUNT=e.rowsCount,this.DATA=e.data,this.I18N=e.i18n,this.INTERACTIVITY=e.interactivity,this.STYLE=e.style,this.TECHNICAL=e.technical,this.DPI_WIDTH=this.WIDTH*2,this.DPI_HEIGHT=this.HEIGHT*2,this.VIEW_WIDTH=this.DPI_WIDTH,this.VIEW_HEIGHT=this.DPI_HEIGHT-this.PADDING*2,this.VERTICES_BOUNDARIES=this.getVerticesBoundaries(this.DATA.vertices),this.X_RATIO=this.VIEW_WIDTH/(h-1),this.Y_RATIO=this.VIEW_HEIGHT/(this.VERTICES_BOUNDARIES[1]-this.VERTICES_BOUNDARIES[0]),this.ROWS_STEP=this.VIEW_HEIGHT/this.ROWS_COUNT,this.TEXT_STEP=(this.VERTICES_BOUNDARIES[1]-this.VERTICES_BOUNDARIES[0])/this.ROWS_COUNT,this.TIMELINE_ITEMS_COUNT=6,this.TIMELINE_ITEMS_STEP=r&&Math.round(r/this.TIMELINE_ITEMS_COUNT),this.resizeHandler=I(this.resizeHandler.bind(this),100),this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.mouseLeaveHandler=this.mouseLeaveHandler.bind(this),this.drawChart=H(this.drawChart.bind(this),1e3/this.INTERACTIVITY.fpsLimit),this.mouse=new Proxy({},{set:(...d)=>{const c=Reflect.set(...d);return this.rafID=window.requestAnimationFrame(this.drawChart),c}}),this.createDOMElements(),this.TECHNICAL.immediateInit&&this.initialize()}createDOMElements(){this.wrapperElement=document.createElement("div"),this.wrapperElement.className="simple-chart",this.canvasElement=document.createElement("canvas"),this.canvasElement.className="simple-chart__canvas",this.canvasElement.width=this.DPI_WIDTH,this.canvasElement.height=this.DPI_HEIGHT,this.canvasElement.style.width=this.WIDTH+"px",this.canvasElement.style.height=this.HEIGHT+"px",this.ctx=this.canvasElement.getContext("2d"),this.tooltipElement=document.createElement("div"),this.tooltipElement.className="simple-chart__tooltip"}initialize(){this.isInitialized||(this.isInitialized=!0,this.wrapperElement.appendChild(this.canvasElement),this.wrapperElement.appendChild(this.tooltipElement),this.TECHNICAL.insertMethod==="append"?this.containerElement.appendChild(this.wrapperElement):this.TECHNICAL.insertMethod==="prepend"?this.containerElement.insertBefore(this.wrapperElement,this.containerElement.firstChild):this.TECHNICAL.insertMethod(this.containerElement,this.wrapperElement),window.addEventListener("resize",this.resizeHandler),window.addEventListener("orientationchange",this.resizeHandler),this.canvasElement.addEventListener("mousemove",this.mouseMoveHandler),this.canvasElement.addEventListener("mouseleave",this.mouseLeaveHandler),this.drawChart())}destroy(){this.isInitialized&&(this.isInitialized=!1,this.wrapperElement.removeChild(this.tooltipElement),this.wrapperElement.removeChild(this.canvasElement),this.containerElement.removeChild(this.wrapperElement),window.cancelAnimationFrame(this.rafID),window.removeEventListener("resize",this.resizeHandler),window.removeEventListener("orientationchange",this.resizeHandler),this.canvasElement.removeEventListener("mousemove",this.mouseMoveHandler),this.canvasElement.removeEventListener("mouseleave",this.mouseLeaveHandler))}drawChart(){this.drawBackground(),this.drawTimeline(),this.drawRows(),this.drawLines()}drawBackground(){this.ctx.fillStyle=this.STYLE.backgroundColor,this.ctx.fillRect(0,0,this.DPI_WIDTH,this.DPI_HEIGHT)}drawTimeline(){if(this.DATA.timeline){this.ctx.fillStyle=this.STYLE.textColor,this.ctx.font=this.STYLE.textFont,this.ctx.lineWidth=2,this.ctx.strokeStyle=this.STYLE.secondaryColor;for(let t=1;t<=this.DATA.timeline.values.length;t++){const i=this.getX(t);if((t-1)%this.TIMELINE_ITEMS_STEP===0){const e=this.getDate(this.DATA.timeline.values[t-1]);this.ctx.fillText(e,i,this.DPI_HEIGHT-10)}this.drawGuideLinesIsOver(i)}}}drawGuideLinesIsOver(t){if(this.mouse.x&&this.mouse.y){const i=this.isMouseVerticeOver(t),e=this.PADDING/2,r=this.DPI_HEIGHT-this.PADDING;if(i&&this.mouse.y>=e)return this.INTERACTIVITY.horisontalGuide&&this.mouse.y<=r&&(this.ctx.beginPath(),this.ctx.setLineDash([20,25]),this.ctx.moveTo(0,this.mouse.y),this.ctx.lineTo(this.DPI_WIDTH,this.mouse.y),this.ctx.stroke(),this.ctx.closePath()),this.ctx.beginPath(),this.ctx.setLineDash([]),this.ctx.moveTo(t,e),this.ctx.lineTo(t,r),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(t,e,2,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath(),!0}return!1}drawRows(){this.ctx.lineWidth=1,this.ctx.strokeStyle=this.STYLE.secondaryColor,this.ctx.fillStyle=this.STYLE.textColor,this.ctx.font=this.STYLE.textFont,this.ctx.beginPath();for(let t=1;t<=this.ROWS_COUNT;t++){const i=String(Math.round(this.VERTICES_BOUNDARIES[1]-this.TEXT_STEP*t)),e=t*this.ROWS_STEP+this.PADDING;this.ctx.fillText(i,5,e-10),this.ctx.moveTo(0,e),this.ctx.lineTo(this.DPI_WIDTH,e)}this.ctx.stroke(),this.ctx.closePath()}drawLines(){this.ctx.lineWidth=4,this.ctx.fillStyle=this.STYLE.backgroundColor;for(const t of this.DATA.vertices){let i=null,e=null;this.ctx.strokeStyle=t.color,this.ctx.beginPath();for(let r=0;r<t.values.length;r++){const h=this.getX(r),o=this.getY(t.values[r]);this.ctx.lineTo(h,o),this.isMouseVerticeOver(h)&&(i=h,e=o)}this.ctx.stroke(),this.ctx.closePath(),i&&e&&this.mouse.x&&this.mouse.y&&this.mouse.y>=this.PADDING/2&&(this.ctx.beginPath(),this.ctx.arc(i,e,this.INTERACTIVITY.guideDotsRadius,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath())}}mouseMoveHandler(t){this.canvasRect??(this.canvasRect=this.canvasElement.getBoundingClientRect()),this.mouse.x=(t.clientX-this.canvasRect.left)*2,this.mouse.y=(t.clientY-this.canvasRect.top)*2}mouseLeaveHandler(){this.mouse.x=null,this.mouse.y=null}resizeHandler(){this.canvasRect=this.canvasElement.getBoundingClientRect()}getVerticesBoundaries(t){let i=null,e=null;for(const r of t)for(const h of r.values)(i===null||h<i)&&(i=h),(e===null||h>e)&&(e=h);return[i??0,e??0]}getDate(t){const i=new Date(t),e=i.getDate(),r=i.getMonth();return`${e} ${this.I18N.months[r]}`}getX(t){return t*this.X_RATIO}getY(t){return this.DPI_HEIGHT-this.PADDING-t*this.Y_RATIO}getVerticesLongestLength(t){t??(t=this.DATA.vertices);let i=0;for(const e of t)e.values.length>i&&(i=e.values.length);return i}isMouseVerticeOver(t){return this.mouse.x?Math.abs(t-this.mouse.x)<this.X_RATIO/2:!1}static validateOptions(t={}){const{width:i,height:e,padding:r,rowsCount:h,data:{timeline:o,vertices:d}={},i18n:{months:c}={},interactivity:{horisontalGuide:p,guideDotsRadius:u,fpsLimit:m}={},style:{textFont:f,textColor:E,secondaryColor:b,backgroundColor:x}={},technical:{insertMethod:y,immediateInit:D}={}}=t;if(i){if(typeof i!="number")throw new s("width should be a number");if(i<=0)throw new s("width should be greater than 0");if(i%2!==0)throw new s("width should be an even number")}if(e){if(typeof e!="number")throw new s("height should be a number");if(e<=0)throw new s("height should be greater than 0");if(e%2!==0)throw new s("height should be an even number")}if(r){if(typeof r!="number")throw new s("padding should be a number");if(r<0)throw new s("padding should be greater or equal to 0")}if(h){if(typeof h!="number")throw new s("rowsCount should be a number");if(h<=0)throw new s("rowsCount should be greater than 0")}if(p&&typeof p!="boolean")throw new s("interactivity.horisontalGuide should be a boolean");if(u){if(typeof u!="number")throw new s("interactivity.guideDotsRadius should be a number");if(u<=0)throw new s("interactivity.guideDotsRadius should be greater than 0")}if(m){if(typeof m!="number")throw new s("interactivity.fpsLimit should be a number");if(m<=0)throw new s("interactivity.fpsLimit should be greater than 0")}if(o){if(typeof o!="object")throw new s("data.timeline should be an object");if(typeof o.type!="string")throw new s("data.timeline.type should be a string");if(!["date"].includes(o.type))throw new s('data.timeline.type should be "date"');if(!Array.isArray(o.values))throw new s("data.timeline.values should be an array");o.type==="date"&&o.values.forEach((w,T)=>{if(typeof w!="number")throw new s(`data.timeline.values[${T}] should be a number`)})}if(d){if(!Array.isArray(d))throw new s("data.vertices should be an array");d.forEach((w,T)=>{if(typeof w.name!="string")throw new s(`data.vertices[${T}].name should be a string`);if(typeof w.color!="string")throw new s(`data.vertices[${T}].color should be a string`);if(!Array.isArray(w.values))throw new s(`data.vertices[${T}].values should be an array`);w.values.forEach((A,_)=>{if(typeof A!="number")throw new s(`data.vertices[${T}].values[${_}] should be a number`)})})}if(c){if(!Array.isArray(c))throw new s("i18n.months should be an array");if(c.length!==12)throw new s("i18n.months should have 12 elements")}if(f&&typeof f!="string")throw new s("style.textFont should be a string");if(E&&typeof E!="string")throw new s("style.textColor should be a string");if(b&&typeof b!="string")throw new s("style.secondaryColor should be a string");if(x&&typeof x!="string")throw new s("style.backgroundColor should be a string");if(y){if(typeof y!="string"&&typeof y!="function")throw new s("technical.insertMethod should be a string or function");if(typeof y=="string"&&!["append","prepend"].includes(y))throw new s('technical.insertMethod should be "append" or "prepend" or function')}if(D&&typeof D!="boolean")throw new s("technical.immediateInit should be a boolean")}static getOptions(t={}){var i,e,r,h,o,d,c,p,u,m,f,E;return this.validateOptions(t),{width:t.width||this.presetOptions.width,height:t.height||this.presetOptions.height,padding:t.padding??this.presetOptions.padding,rowsCount:t.rowsCount||this.presetOptions.rowsCount,data:{timeline:((i=t.data)==null?void 0:i.timeline)||this.presetOptions.data.timeline,vertices:((e=t.data)==null?void 0:e.vertices)||this.presetOptions.data.vertices},i18n:{months:((r=t.i18n)==null?void 0:r.months)||this.presetOptions.i18n.months},interactivity:{horisontalGuide:((h=t.interactivity)==null?void 0:h.horisontalGuide)||this.presetOptions.interactivity.horisontalGuide,guideDotsRadius:((o=t.interactivity)==null?void 0:o.guideDotsRadius)||this.presetOptions.interactivity.guideDotsRadius,fpsLimit:((d=t.interactivity)==null?void 0:d.fpsLimit)||this.presetOptions.interactivity.fpsLimit},style:{textFont:((c=t.style)==null?void 0:c.textFont)||this.presetOptions.style.textFont,textColor:((p=t.style)==null?void 0:p.textColor)||this.presetOptions.style.textColor,secondaryColor:((u=t.style)==null?void 0:u.secondaryColor)||this.presetOptions.style.secondaryColor,backgroundColor:((m=t.style)==null?void 0:m.backgroundColor)||this.presetOptions.style.backgroundColor},technical:{insertMethod:((f=t.technical)==null?void 0:f.insertMethod)||this.presetOptions.technical.insertMethod,immediateInit:((E=t.technical)==null?void 0:E.immediateInit)||this.presetOptions.technical.immediateInit}}}static changePresetOptions(t={}){var i,e,r,h,o,d,c,p,u,m,f,E;this.validateOptions(t),this.presetOptions.width=t.width||this.presetOptions.width,this.presetOptions.height=t.height||this.presetOptions.height,this.presetOptions.padding=t.padding??this.presetOptions.padding,this.presetOptions.rowsCount=t.rowsCount||this.presetOptions.rowsCount,this.presetOptions.data.timeline=((i=t.data)==null?void 0:i.timeline)||this.presetOptions.data.timeline,this.presetOptions.data.vertices=((e=t.data)==null?void 0:e.vertices)||this.presetOptions.data.vertices,this.presetOptions.i18n.months=((r=t.i18n)==null?void 0:r.months)||this.presetOptions.i18n.months,this.presetOptions.interactivity.horisontalGuide=((h=t.interactivity)==null?void 0:h.horisontalGuide)||this.presetOptions.interactivity.horisontalGuide,this.presetOptions.interactivity.guideDotsRadius=((o=t.interactivity)==null?void 0:o.guideDotsRadius)||this.presetOptions.interactivity.guideDotsRadius,this.presetOptions.interactivity.fpsLimit=((d=t.interactivity)==null?void 0:d.fpsLimit)||this.presetOptions.interactivity.fpsLimit,this.presetOptions.style.textFont=((c=t.style)==null?void 0:c.textFont)||this.presetOptions.style.textFont,this.presetOptions.style.textColor=((p=t.style)==null?void 0:p.textColor)||this.presetOptions.style.textColor,this.presetOptions.style.secondaryColor=((u=t.style)==null?void 0:u.secondaryColor)||this.presetOptions.style.secondaryColor,this.presetOptions.style.backgroundColor=((m=t.style)==null?void 0:m.backgroundColor)||this.presetOptions.style.backgroundColor,this.presetOptions.technical.insertMethod=((f=t.technical)==null?void 0:f.insertMethod)||this.presetOptions.technical.insertMethod,this.presetOptions.technical.immediateInit=((E=t.technical)==null?void 0:E.immediateInit)||this.presetOptions.technical.immediateInit}};n(g,"presetOptions",{width:600,height:250,padding:40,rowsCount:5,data:{timeline:null,vertices:[]},i18n:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},interactivity:{horisontalGuide:!0,guideDotsRadius:8,fpsLimit:60},style:{textFont:"normal 20px Helvetica,sans-serif",textColor:"#96a2aa",secondaryColor:"#bbbbbb",backgroundColor:"#ffffff"},technical:{insertMethod:"append",immediateInit:!0}});let O=g;a.Chart=O,a.ChartError=C,a.ChartOptionsError=s,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
