(function(l,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(l=typeof globalThis<"u"?globalThis:l||self,d(l.SimpleChartsJS={}))})(this,function(l){"use strict";var S=Object.defineProperty;var C=(l,d,m)=>d in l?S(l,d,{enumerable:!0,configurable:!0,writable:!0,value:m}):l[d]=m;var n=(l,d,m)=>(C(l,typeof d!="symbol"?d+"":d,m),m);const d="";function m(E,t){let s;return(...e)=>{clearTimeout(s),s=setTimeout(()=>E(...e),t)}}class I extends Error{constructor(t){super(t),this.name="ChartError"}}class i extends I{constructor(t){super(t),this.name="ChartOptionsError"}}const g=class g{constructor(t,s={}){n(this,"WIDTH");n(this,"HEIGHT");n(this,"PADDING");n(this,"ROWS_COUNT");n(this,"GUIDE_DOTS_RADIUS");n(this,"DATA");n(this,"I18N");n(this,"STYLE");n(this,"FLAGS");n(this,"INSERT_METHOD");n(this,"DPI_WIDTH");n(this,"DPI_HEIGHT");n(this,"VIEW_WIDTH");n(this,"VIEW_HEIGHT");n(this,"Y_AXIS_DATA_BOUNDARIES");n(this,"X_RATIO");n(this,"Y_RATIO");n(this,"ROWS_STEP");n(this,"TEXT_STEP");n(this,"X_AXIS_DATA_COUNT");n(this,"X_AXIS_DATA_STEP");n(this,"mouse");n(this,"isInitialized",!1);n(this,"rafID",0);n(this,"containerElement");n(this,"wrapperElement");n(this,"canvasElement");n(this,"tooltipElement");n(this,"canvasRect");n(this,"ctx");var o;const e=g.getOptions(s),h=((o=e.data.xAxis)==null?void 0:o.values.length)||0,r=this.getAxisYDataLength(e.data.yAxis);this.containerElement=t,this.WIDTH=e.width,this.HEIGHT=e.height,this.PADDING=e.padding,this.ROWS_COUNT=e.rowsCount,this.GUIDE_DOTS_RADIUS=e.guideDotsRadius,this.DATA=e.data,this.I18N=e.i18n,this.STYLE=e.style,this.FLAGS=e.flags,this.INSERT_METHOD=e.insertMethod,this.DPI_WIDTH=this.WIDTH*2,this.DPI_HEIGHT=this.HEIGHT*2,this.VIEW_WIDTH=this.DPI_WIDTH,this.VIEW_HEIGHT=this.DPI_HEIGHT-this.PADDING*2,this.Y_AXIS_DATA_BOUNDARIES=this.getYAxisDataBoundaries(this.DATA.yAxis),this.X_RATIO=this.VIEW_WIDTH/(r-1),this.Y_RATIO=this.VIEW_HEIGHT/(this.Y_AXIS_DATA_BOUNDARIES[1]-this.Y_AXIS_DATA_BOUNDARIES[0]),this.ROWS_STEP=this.VIEW_HEIGHT/this.ROWS_COUNT,this.TEXT_STEP=(this.Y_AXIS_DATA_BOUNDARIES[1]-this.Y_AXIS_DATA_BOUNDARIES[0])/this.ROWS_COUNT,this.X_AXIS_DATA_COUNT=6,this.X_AXIS_DATA_STEP=h&&Math.round(h/this.X_AXIS_DATA_COUNT),this.resizeHandler=m(this.resizeHandler.bind(this),100),this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.mouseLeaveHandler=this.mouseLeaveHandler.bind(this),this.drawChart=this.drawChart.bind(this),this.mouse=new Proxy({},{set:(...a)=>{const u=Reflect.set(...a);return this.rafID=window.requestAnimationFrame(this.drawChart),u}}),this.createDOMElements(),this.FLAGS.immediateInit&&this.initialize()}createDOMElements(){this.wrapperElement=document.createElement("div"),this.wrapperElement.className="simple-chart",this.canvasElement=document.createElement("canvas"),this.canvasElement.className="simple-chart__canvas",this.canvasElement.width=this.DPI_WIDTH,this.canvasElement.height=this.DPI_HEIGHT,this.canvasElement.style.width=this.WIDTH+"px",this.canvasElement.style.height=this.HEIGHT+"px",this.ctx=this.canvasElement.getContext("2d"),this.tooltipElement=document.createElement("div"),this.tooltipElement.className="simple-chart__tooltip"}initialize(){this.isInitialized||(this.isInitialized=!0,this.INSERT_METHOD==="append"?this.containerElement.appendChild(this.wrapperElement):this.INSERT_METHOD==="prepend"?this.containerElement.insertBefore(this.wrapperElement,this.containerElement.firstChild):this.INSERT_METHOD(this.containerElement,this.wrapperElement),this.wrapperElement.appendChild(this.canvasElement),this.wrapperElement.appendChild(this.tooltipElement),window.addEventListener("resize",this.resizeHandler),window.addEventListener("orientationchange",this.resizeHandler),this.canvasElement.addEventListener("mousemove",this.mouseMoveHandler),this.canvasElement.addEventListener("mouseleave",this.mouseLeaveHandler),this.drawChart())}destroy(){this.isInitialized&&(this.isInitialized=!1,this.wrapperElement.removeChild(this.tooltipElement),this.wrapperElement.removeChild(this.canvasElement),this.containerElement.removeChild(this.wrapperElement),window.cancelAnimationFrame(this.rafID),window.removeEventListener("resize",this.resizeHandler),window.removeEventListener("orientationchange",this.resizeHandler),this.canvasElement.removeEventListener("mousemove",this.mouseMoveHandler),this.canvasElement.removeEventListener("mouseleave",this.mouseLeaveHandler))}drawChart(){console.log("draw"),this.drawBackground(),this.drawAxisX(),this.drawAxisY(),this.drawLines()}drawBackground(){this.ctx.fillStyle=this.STYLE.backgroundColor,this.ctx.fillRect(0,0,this.DPI_WIDTH,this.DPI_HEIGHT)}drawAxisX(){if(this.DATA.xAxis){this.ctx.fillStyle=this.STYLE.textColor,this.ctx.font=this.STYLE.textFont,this.ctx.lineWidth=2,this.ctx.strokeStyle=this.STYLE.secondaryColor;for(let t=1;t<=this.DATA.xAxis.values.length;t++){const s=this.getX(t);if((t-1)%this.X_AXIS_DATA_STEP===0){const e=this.getDate(this.DATA.xAxis.values[t-1]);this.ctx.fillText(e,s,this.DPI_HEIGHT-10)}this.drawGuideLinesIsOver(s)}}}drawGuideLinesIsOver(t){if(this.mouse.x&&this.mouse.y){const s=this.isMouseOverYAxisDataItem(t),e=this.PADDING/2,h=this.DPI_HEIGHT-this.PADDING;if(s&&this.mouse.y>=e)return this.FLAGS.horGuide&&this.mouse.y<=h&&(this.ctx.beginPath(),this.ctx.setLineDash([20,25]),this.ctx.moveTo(0,this.mouse.y),this.ctx.lineTo(this.DPI_WIDTH,this.mouse.y),this.ctx.stroke(),this.ctx.closePath()),this.ctx.beginPath(),this.ctx.setLineDash([]),this.ctx.moveTo(t,e),this.ctx.lineTo(t,h),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(t,e,2,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath(),!0}return!1}drawAxisY(){this.ctx.lineWidth=1,this.ctx.strokeStyle=this.STYLE.secondaryColor,this.ctx.fillStyle=this.STYLE.textColor,this.ctx.font=this.STYLE.textFont,this.ctx.beginPath();for(let t=1;t<=this.ROWS_COUNT;t++){const s=String(Math.round(this.Y_AXIS_DATA_BOUNDARIES[1]-this.TEXT_STEP*t)),e=t*this.ROWS_STEP+this.PADDING;this.ctx.fillText(s,5,e-10),this.ctx.moveTo(0,e),this.ctx.lineTo(this.DPI_WIDTH,e)}this.ctx.stroke(),this.ctx.closePath()}drawLines(){this.ctx.lineWidth=4,this.ctx.fillStyle=this.STYLE.backgroundColor;for(const t of this.DATA.yAxis){let s=null,e=null;this.ctx.strokeStyle=t.color,this.ctx.beginPath();for(let h=0;h<t.values.length;h++){const r=this.getX(h),o=this.getY(t.values[h]);this.ctx.lineTo(r,o),this.isMouseOverYAxisDataItem(r)&&(s=r,e=o)}this.ctx.stroke(),this.ctx.closePath(),s&&e&&this.mouse.x&&this.mouse.y&&this.mouse.y>=this.PADDING/2&&(this.ctx.beginPath(),this.ctx.arc(s,e,this.GUIDE_DOTS_RADIUS,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath())}}mouseMoveHandler(t){this.canvasRect??(this.canvasRect=this.canvasElement.getBoundingClientRect()),this.mouse.x=(t.clientX-this.canvasRect.left)*2,this.mouse.y=(t.clientY-this.canvasRect.top)*2}mouseLeaveHandler(){this.mouse.x=null,this.mouse.y=null}resizeHandler(){this.canvasRect=this.canvasElement.getBoundingClientRect()}getYAxisDataBoundaries(t){let s=null,e=null;for(const h of t)for(const r of h.values)(s===null||r<s)&&(s=r),(e===null||r>e)&&(e=r);return[s??0,e??0]}getDate(t){const s=new Date(t),e=s.getDate(),h=s.getMonth();return`${e} ${this.I18N.months[h]}`}getX(t){return t*this.X_RATIO}getY(t){return this.DPI_HEIGHT-this.PADDING-t*this.Y_RATIO}getAxisYDataLength(t){t??(t=this.DATA.yAxis);let s=0;for(const e of t)e.values.length>s&&(s=e.values.length);return s}isMouseOverYAxisDataItem(t){const s=this.getAxisYDataLength()-1;return!s||!this.mouse.x?!1:Math.abs(t-this.mouse.x)<this.DPI_WIDTH/s/2}static validateOptions(t={}){const{width:s,height:e,padding:h,rowsCount:r,guideDotsRadius:o,data:{xAxis:a,yAxis:u}={},i18n:{months:c}={},style:{textFont:p,textColor:y,secondaryColor:D,backgroundColor:T}={},flags:{horGuide:O,immediateInit:_}={},insertMethod:A}=t;if(s){if(typeof s!="number")throw new i("width should be a number");if(s<=0)throw new i("width should be greater than 0");if(s%2!==0)throw new i("width should be an even number")}if(e){if(typeof e!="number")throw new i("height should be a number");if(e<=0)throw new i("height should be greater than 0");if(e%2!==0)throw new i("height should be an even number")}if(h){if(typeof h!="number")throw new i("padding should be a number");if(h<0)throw new i("padding should be greater or equal to 0")}if(r){if(typeof r!="number")throw new i("rowsCount should be a number");if(r<=0)throw new i("rowsCount should be greater than 0")}if(o){if(typeof o!="number")throw new i("guideDotsRadius should be a number");if(o<=0)throw new i("guideDotsRadius should be greater than 0")}if(a){if(typeof a!="object")throw new i("data.xAxis should be an object");if(typeof a.type!="string")throw new i("data.xAxis.type should be a string");if(!["date"].includes(a.type))throw new i('data.xAxis.type should be "date"');if(!Array.isArray(a.values))throw new i("data.xAxis.values should be an array");a.type==="date"&&a.values.forEach((f,x)=>{if(typeof f!="number")throw new i(`data.xAxis.values[${x}] should be a number`)})}if(u){if(!Array.isArray(u))throw new i("data.columns should be an array");u.forEach((f,x)=>{if(typeof f.name!="string")throw new i(`data.yAxis[${x}].name should be a string`);if(typeof f.color!="string")throw new i(`data.yAxis[${x}].color should be a string`);if(!Array.isArray(f.values))throw new i(`data.yAxis[${x}].values should be an array`);f.values.forEach((v,b)=>{if(typeof v!="number")throw new i(`data.yAxis[${x}].values[${b}] should be a number`)})})}if(c){if(!Array.isArray(c))throw new i("i18n.months should be an array");if(c.length!==12)throw new i("i18n.months should have 12 elements")}if(p&&typeof p!="string")throw new i("style.textFont should be a string");if(y&&typeof y!="string")throw new i("style.textColor should be a string");if(D&&typeof D!="string")throw new i("style.secondaryColor should be a string");if(T&&typeof T!="string")throw new i("style.backgroundColor should be a string");if(O&&typeof O!="boolean")throw new i("flags.horGuide should be a boolean");if(_&&typeof _!="boolean")throw new i("flags.immediateInit should be a boolean");if(A){if(typeof A!="string"&&typeof A!="function")throw new i("insertMethod should be a string or function");if(typeof A=="string"&&!["append","prepend"].includes(A))throw new i('insertMethod should be "append" or "prepend" or function')}}static getOptions(t={}){var s,e,h,r,o,a,u,c,p;return this.validateOptions(t),{width:t.width||this.presetOptions.width,height:t.height||this.presetOptions.height,padding:t.padding??this.presetOptions.padding,rowsCount:t.rowsCount||this.presetOptions.rowsCount,guideDotsRadius:t.guideDotsRadius||this.presetOptions.guideDotsRadius,data:{xAxis:((s=t.data)==null?void 0:s.xAxis)||this.presetOptions.data.xAxis,yAxis:((e=t.data)==null?void 0:e.yAxis)||this.presetOptions.data.yAxis},i18n:{months:((h=t.i18n)==null?void 0:h.months)||this.presetOptions.i18n.months},style:{textFont:((r=t.style)==null?void 0:r.textFont)||this.presetOptions.style.textFont,textColor:((o=t.style)==null?void 0:o.textColor)||this.presetOptions.style.textColor,secondaryColor:((a=t.style)==null?void 0:a.secondaryColor)||this.presetOptions.style.secondaryColor,backgroundColor:((u=t.style)==null?void 0:u.backgroundColor)||this.presetOptions.style.backgroundColor},flags:{horGuide:((c=t.flags)==null?void 0:c.horGuide)??this.presetOptions.flags.horGuide,immediateInit:((p=t.flags)==null?void 0:p.immediateInit)??this.presetOptions.flags.immediateInit},insertMethod:t.insertMethod||this.presetOptions.insertMethod}}static changePresetOptions(t={}){var s,e,h,r,o,a,u,c,p;this.validateOptions(t),this.presetOptions.width=t.width||this.presetOptions.width,this.presetOptions.height=t.height||this.presetOptions.height,this.presetOptions.padding=t.padding??this.presetOptions.padding,this.presetOptions.rowsCount=t.rowsCount||this.presetOptions.rowsCount,this.presetOptions.guideDotsRadius=t.guideDotsRadius||this.presetOptions.guideDotsRadius,this.presetOptions.i18n.months=((s=t.i18n)==null?void 0:s.months)||this.presetOptions.i18n.months,this.presetOptions.style.textFont=((e=t.style)==null?void 0:e.textFont)||this.presetOptions.style.textFont,this.presetOptions.style.textColor=((h=t.style)==null?void 0:h.textColor)||this.presetOptions.style.textColor,this.presetOptions.style.secondaryColor=((r=t.style)==null?void 0:r.secondaryColor)||this.presetOptions.style.secondaryColor,this.presetOptions.style.backgroundColor=((o=t.style)==null?void 0:o.backgroundColor)||this.presetOptions.style.backgroundColor,this.presetOptions.data.xAxis=((a=t.data)==null?void 0:a.xAxis)||this.presetOptions.data.xAxis,this.presetOptions.data.yAxis=((u=t.data)==null?void 0:u.yAxis)||this.presetOptions.data.yAxis,this.presetOptions.flags.horGuide=((c=t.flags)==null?void 0:c.horGuide)??this.presetOptions.flags.horGuide,this.presetOptions.flags.immediateInit=((p=t.flags)==null?void 0:p.immediateInit)??this.presetOptions.flags.immediateInit,this.presetOptions.insertMethod=t.insertMethod||this.presetOptions.insertMethod}};n(g,"presetOptions",{width:600,height:250,padding:40,rowsCount:5,guideDotsRadius:8,data:{xAxis:null,yAxis:[]},i18n:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},style:{textFont:"normal 20px Helvetica,sans-serif",textColor:"#96a2aa",secondaryColor:"#bbbbbb",backgroundColor:"#ffffff"},flags:{horGuide:!0,immediateInit:!0},insertMethod:"append"});let w=g;l.Chart=w,l.ChartError=I,l.ChartOptionsError=i,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
